(this["webpackJsonpshashi-chat-app"]=this["webpackJsonpshashi-chat-app"]||[]).push([[0],{133:function(e,a,t){},134:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(30),o=t.n(c),m=(t(62),t(63),t(56)),l=(t(64),t(7)),i=t(16),s=t(17),u=t(23),p=t(11),f=t(135),d=t(136),h=t(137),E=t(138),g=t(139),v=t(140),b=t(141),k=t(27),y=t.n(k);t(74);y.a.initializeApp({apiKey:"AIzaSyCpjSisGMYrvBXOLKQ4ULaeNmK5zU_8K-w",authDomain:"shashichatapp.firebaseapp.com",databaseURL:"https://shashichatapp-default-rtdb.firebaseio.com",projectId:"shashichatapp",storageBucket:"shashichatapp.appspot.com",messagingSenderId:"837915550458",appId:"1:837915550458:web:df32edf2030c97e2159f43"});var j=y.a.storage(),O=y.a.database();var w=function(){var e=Object(l.g)(),a=Object(n.useState)({nickname:""}),t=Object(p.a)(a,2),c=t[0],o=t[1],m=Object(n.useState)(!1),i=Object(p.a)(m,2),k=i[0],y=i[1],j=O.ref("users/");return r.a.createElement("div",null,k&&r.a.createElement(f.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement(h.a,{onSubmit:function(a){a.preventDefault(),y(!0),j.orderByChild("nickname").equalTo(c.nickname).once("value",(function(a){a.exists()?(localStorage.setItem("nickname",c.nickname),e.push("/roomlist"),y(!1)):(O.ref("users/").push().set(c),localStorage.setItem("nickname",c.nickname),e.push("/roomlist"),y(!1))}))}},r.a.createElement(E.a,null,r.a.createElement(g.a,null,"Nickname"),r.a.createElement(v.a,{type:"text",name:"nickname",id:"nickname",placeholder:"Enter Your Nickname",value:c.nickname,onChange:function(e){e.persist(),o(Object(u.a)({},c,Object(s.a)({},e.target.name,e.target.value)))}})),r.a.createElement(b.a,{variant:"primary",type:"submit"},"Login"))))},S=t(20),C=t.n(S),N=t(28),x=t(142),B=t(143),I=t(31),R=t.n(I);var D=function(){var e=Object(n.useState)([]),a=Object(p.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)(!0),m=Object(p.a)(o,2),s=m[0],u=m[1],h=Object(n.useState)(""),E=Object(p.a)(h,2),g=E[0],v=E[1],k=Object(l.g)();Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v(localStorage.getItem("nickname")),O.ref("rooms/").on("value",(function(e){c([]),c(y(e)),u(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var y=function(e){var a=[];return e.forEach((function(e){var t=e.val();t.key=e.key,a.push(t)})),a};return r.a.createElement("div",null,s&&r.a.createElement(f.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement("h3",null,g," ",r.a.createElement(b.a,{onClick:function(){localStorage.removeItem("nickname"),k.push("/login")}},"Logout")),r.a.createElement("h2",null,"Room List"),r.a.createElement("div",null,r.a.createElement(i.b,{to:"/addroom"},"Add Room")),r.a.createElement(x.a,null,t.map((function(e,a){return r.a.createElement(B.a,{key:a,action:!0,onClick:function(){!function(e){var a={roomname:"",nickname:"",message:"",date:"",type:""};a.roomname=e,a.nickname=g,a.type="join",O.ref("chats/").push().set(a),O.ref("roomusers/").orderByChild("roomname").equalTo(e).on("value",(function(a){var t=y(a).find((function(e){return e.nickname===g}));if(void 0!==t){O.ref("roomusers/"+t.key).update({status:"online"})}else{var n={roomname:"",nickname:"",status:""};n.roomname=e,n.nickname=g,n.status="online",O.ref("roomusers/").push().set(n)}})),k.push("/chatroom/"+e)}(e.roomname)}},e.roomname)})))))},L=t(151);var M=function(){var e=Object(l.g)(),a=Object(n.useState)({roomname:""}),t=Object(p.a)(a,2),c=t[0],o=t[1],m=Object(n.useState)(!1),i=Object(p.a)(m,2),k=i[0],y=i[1],j=O.ref("rooms/");return r.a.createElement("div",null,k&&r.a.createElement(f.a,{color:"primary"}),r.a.createElement(d.a,null,r.a.createElement("h2",null,"Please enter new Room"),r.a.createElement(h.a,{onSubmit:function(a){a.preventDefault(),y(!0),j.orderByChild("roomname").equalTo(c.roomname).once("value",(function(a){if(a.exists())return r.a.createElement("div",null,r.a.createElement(L.a,{color:"primary"},"Room name already exist!"));O.ref("rooms/").push().set(c),e.goBack(),y(!1)}))}},r.a.createElement(E.a,null,r.a.createElement(g.a,null,"Room Name"),r.a.createElement(v.a,{type:"text",name:"roomname",id:"roomname",placeholder:"Enter Room Name",value:c.roomname,onChange:function(e){e.persist(),o(Object(u.a)({},c,Object(s.a)({},e.target.name,e.target.value)))}})),r.a.createElement(b.a,{variant:"primary",type:"submit"},"Add"))))},U=t(144),Y=t(145),T=t(146),q=t(147),A=t(148),H=t(149),J=t(150),K=t(152),z=t(55),F=t.n(z);var W=function(e){return r.a.createElement("div",{className:"App"},r.a.createElement("center",null,r.a.createElement("input",{type:"file",accept:"image/png, image/jpeg",onChange:function(a){e.setImage(a.target.files[0])}})))};t(133);var G=function(){var e=Object(n.useState)([]),a=Object(p.a)(e,2),t=a[0],c=a[1],o=Object(n.useState)([]),m=Object(p.a)(o,2),i=m[0],f=m[1],d=Object(n.useState)(""),E=Object(p.a)(d,2),g=E[0],k=E[1],y=Object(n.useState)(""),w=Object(p.a)(y,2),S=w[0],x=w[1],B=Object(n.useState)(""),I=Object(p.a)(B,2),D=I[0],L=I[1],M=Object(n.useState)({roomname:"",nickname:"",message:"",date:"",type:"",imageURL:""}),z=Object(p.a)(M,2),G=z[0],P=z[1],Q=Object(l.g)(),X=Object(l.i)().room;Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(localStorage.getItem("nickname")),L(X),O.ref("chats/").orderByChild("roomname").equalTo(D).on("value",(function(e){c($(e))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[X,D]),Object(n.useEffect)((function(){(function(){var e=Object(N.a)(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(localStorage.getItem("nickname")),L(X),O.ref("roomusers/").orderByChild("roomname").equalTo(D).on("value",(function(e){f([]);var a=$(e);f(a.filter((function(e){return"online"===e.status})))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[X,D]);var $=function(e){var a=[];return e.forEach((function(e){var t=e.val();t.key=e.key,a.push(t)})),a},_=function(e){var a=JSON.parse(JSON.stringify(G));a.roomname=D,a.nickname=g,a.date=R()(new Date).format("DD/MM/YYYY HH:mm:ss"),a.type="image",a.imageURL=e,O.ref("chats/").push().set(a),x("")};return r.a.createElement("div",{className:"Container"},r.a.createElement(U.a,null,r.a.createElement(Y.a,null,r.a.createElement(T.a,{xs:"4"},r.a.createElement("div",null,r.a.createElement(q.a,{className:"UsersCard"},r.a.createElement(A.a,null,r.a.createElement(H.a,null,r.a.createElement(b.a,{variant:"primary",type:"button",onClick:function(){!function(e){var a={roomname:"",nickname:"",message:"",date:"",type:""};a.roomname=D,a.nickname=g,a.type="exit",O.ref("chats/").push().set(a),O.ref("roomusers/").orderByChild("roomname").equalTo(D).once("value",(function(e){var a=$(e).find((function(e){return e.nickname===g}));void 0!==a&&O.ref("roomusers/"+a.key).update({status:"offline"})})),Q.goBack()}()}},"Exit Chat")))),i.map((function(e,a){return r.a.createElement(q.a,{key:a,className:"UsersCard"},r.a.createElement(A.a,null,r.a.createElement(H.a,null,e.nickname)))})))),r.a.createElement(T.a,{xs:"8"},r.a.createElement(F.a,{className:"ChatContent"},t.map((function(e,a){return r.a.createElement("div",{key:a,className:"MessageBox"},"join"===e.type||"exit"===e.type?r.a.createElement("div",{className:"ChatStatus"},r.a.createElement("span",{className:"ChatDate"},e.date),r.a.createElement("span",{className:"ChatContentCenter"},e.message)):r.a.createElement("div",{className:"ChatMessage"},r.a.createElement("div",{className:"".concat(e.nickname===g?"RightBubble":"LeftBubble")},e.nickname===g?r.a.createElement("span",{className:"MsgName"},"Me"):r.a.createElement("span",{className:"MsgName"},e.nickname),r.a.createElement("span",{className:"MsgDate"}," at ",e.date),"image"===e.type?r.a.createElement("div",{className:"image-container"}," ",r.a.createElement("img",{src:e.imageURL,alt:"image"})):r.a.createElement("p",null,e.message))))}))),r.a.createElement("footer",{className:"StickyFooter"},r.a.createElement(h.a,{className:"MessageForm",onSubmit:function(e){e.preventDefault();var a=G;if(a.roomname=D,a.nickname=g,a.date=R()(new Date).format("DD/MM/YYYY HH:mm:ss"),a.type="message",S){var t=window.performance&&window.performance.now&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.now()+window.performance.timing.navigationStart:Date.now();j.ref("/images/".concat(t).concat(S.name)).put(S).then((function(){j.ref("/images/".concat(t).concat(S.name)).getDownloadURL().then((function(e){_(e)}))}))}else{O.ref("chats/").push().set(a),P({roomname:"",nickname:"",message:"",date:"",type:"",imageURL:""})}}},r.a.createElement(J.a,null,r.a.createElement(v.a,{type:"text",name:"message",id:"message",placeholder:"Enter message here",value:G.message,onChange:function(e){e.persist(),P(Object(u.a)({},G,Object(s.a)({},e.target.name,e.target.value)))}}),r.a.createElement(W,{uploadImage:_,setImage:function(e){x(e),G.imageURL&&(G.imageURL="",P(G))}}),r.a.createElement(K.a,{addonType:"append"},r.a.createElement(b.a,{variant:"primary",type:"submit"},"Send")))))))))};var P=function(){var e=Object(l.h)();return r.a.createElement(i.a,null,r.a.createElement("div",null,r.a.createElement(l.a,{to:{pathname:"/roomlist",state:{from:e}}}),r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/login"},r.a.createElement(w,null)),r.a.createElement(Q,{path:"/roomlist"},r.a.createElement(D,null)),r.a.createElement(Q,{path:"/addroom"},r.a.createElement(M,null)),r.a.createElement(Q,{path:"/chatroom/:room"},r.a.createElement(G,null)))))};function Q(e){var a=e.children,t=Object(m.a)(e,["children"]);return r.a.createElement(l.b,Object.assign({},t,{render:function(e){var t=e.location;return localStorage.getItem("nickname")?a:r.a.createElement(l.a,{to:{pathname:"/login",state:{from:t}}})}}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(i.a,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},57:function(e,a,t){e.exports=t(134)},63:function(e,a,t){},64:function(e,a,t){}},[[57,1,2]]]);
//# sourceMappingURL=main.ef3387dd.chunk.js.map